---
layout: post
title:  "ROPE位置编码"
date:   2025-06-24 09:20:08 +0800
category: "AI"
published: true
---

ROPE位置编码的文章很多，苏神的博客也讲得很清楚，为什么我还要写一篇？因为我想按照自己的思路捋一下，就酱紫。

<!--more-->

## 1、为什么需要位置编码-Transformer的对称性缺陷
<div id="threejs-demo" style="width: 100%; height: 300px; border: 1px solid #ccc; margin: 20px 0; position: relative; background: #f9f9f9;">
</div>

<button onclick="startRotation()" style="margin: 10px 5px; padding: 8px 16px; background: #4CAF50; color: white; border: none; border-radius: 4px; cursor: pointer;">开始旋转</button>
<button onclick="stopRotation()" style="margin: 10px 5px; padding: 8px 16px; background: #2196F3; color: white; border: none; border-radius: 4px; cursor: pointer;">停止旋转</button>
<button onclick="resetSphere()" style="margin: 10px 5px; padding: 8px 16px; background: #FF9800; color: white; border: none; border-radius: 4px; cursor: pointer;">重置</button>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
let scene, camera, renderer, sphere;
let isRotating = false;

function initThreeJS() {
  const container = document.getElementById('threejs-demo');
  if (!container) return;
  
  // 创建场景
  scene = new THREE.Scene();
  scene.background = new THREE.Color(0xf9f9f9);
  
  // 创建相机
  camera = new THREE.PerspectiveCamera(75, container.offsetWidth / container.offsetHeight, 0.1, 1000);
  camera.position.z = 5;
  
  // 创建渲染器
  renderer = new THREE.WebGLRenderer({ antialias: true });
  renderer.setSize(container.offsetWidth, container.offsetHeight);
  container.appendChild(renderer.domElement);
  
  // 创建球体几何体和材质
  const geometry = new THREE.SphereGeometry(1, 32, 32);
  const material = new THREE.MeshBasicMaterial({ 
    color: 0x4CAF50,
    wireframe: true
  });
  
  // 创建球体网格
  sphere = new THREE.Mesh(geometry, material);
  scene.add(sphere);
  
  // 添加光源
  const light = new THREE.DirectionalLight(0xffffff, 1);
  light.position.set(1, 1, 1);
  scene.add(light);
  
  // 渲染场景
  renderer.render(scene, camera);
}

function animate() {
  if (isRotating) {
    sphere.rotation.x += 0.01;
    sphere.rotation.y += 0.01;
    renderer.render(scene, camera);
    requestAnimationFrame(animate);
  }
}

function startRotation() {
  isRotating = true;
  animate();
}

function stopRotation() {
  isRotating = false;
}

function resetSphere() {
  isRotating = false;
  sphere.rotation.x = 0;
  sphere.rotation.y = 0;
  renderer.render(scene, camera);
}

// 页面加载时初始化
document.addEventListener('DOMContentLoaded', function() {
  setTimeout(initThreeJS, 100);
});

// 窗口大小改变时调整渲染器大小
window.addEventListener('resize', function() {
  const container = document.getElementById('threejs-demo');
  if (container && camera && renderer) {
    camera.aspect = container.offsetWidth / container.offsetHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(container.offsetWidth, container.offsetHeight);
    renderer.render(scene, camera);
  }
});
</script>

<p style="color: #666; font-size: 14px; margin-top: 10px;">
💡 这个旋转的球体展示了Three.js的基本框架，可以在此基础上构建更复杂的3D可视化来展示ROPE位置编码的概念。
</p>
