---
layout: post
title:  "ELF文件分析(二)"
date:   2022-02-09 10:04:08 +0800
tags: 计算机基础
---

> 在ELF文件分析(一)中，我们大概了解了ELF文件的结构，知道了ELF文件由文件头和段组成。今天我们继续学习ELF文件的链接。

# 段的具体结构
上篇文章中，我们知道段表中存储着每个段的基本信息，这些基本信息用一个叫**段描述符**的结构来组织。
想要查看段描述符的结构，可以在 /usr/include/elf.h中搜Elf32_Shdr，如下所示：
```c
typedef struct
{
  Elf32_Word    sh_name;  /* Section name (string tbl index) */
  Elf32_Word    sh_type; /* Section type */
  Elf32_Word    sh_flags;/* Section flags */
  Elf32_Addr    sh_addr; /* Section virtual addr at execution */
  Elf32_Off     sh_offset; /* Section file offset */
  Elf32_Word    sh_size; /* Section size in bytes */
  Elf32_Word    sh_link; /* Link to another section */
  Elf32_Word    sh_info; /* Additional section information */
  Elf32_Word    sh_addralign;/* Section alignment */
  Elf32_Word    sh_entsize;  /* Entry size if section holds table */
} Elf32_Shdr;
```
看到这么多字段，不要想一下子搞清楚所有的字段含义，也不要有畏难情绪。现阶段，我们只需要掌握主要的几个字段就够了。

前缀sh表示的是section header。

- sh_offset

表示该段在文件中的偏移量。相当于该段在文件中的起始地址。
**注意：** 这里的偏移单位是字节。

- sh_size 

表示该段的长度。有了sh_offset和sh_size，我们就可以**从文件中完整地取出该段的内容。**

- sh_addr

表示段虚拟地址，这是指当进程需要将该段加载到进程地址空间时，请加载到这个地址。

其余的字段，有的看名字就知道含义，不知道的，暂时不用管。

# 符号段和字符串段
在计算机程序中，我们需要定义很多符号，回顾下上一篇文章中的示例代码：
```c

```


